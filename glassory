# numberOfES = sum(1 for s in entryList if 'ES' in s) + sum(1 for s in exitsList if 'ES' in s)

    # print to ini file
    inifile = open(iniFileName, "a")
    inifile.write("\n")


endOfFile = sheet3[sheet3.isnull().all(axis=1) == True].index.tolist()[0] # get final line number
ESNamesList = sheet3[Sheet3_column1].values.tolist()
sourceIDList = sheet3[Sheet3_column2].values.toList()
sourceDatarateList = sheet3[Sheet3_column3].values.toList()
cableLengthList = sheet3[Sheet3_column4].values.tolist()
vlidList = sheet3[Sheet3_column5].values.tolist()
startTimeList = sheet3[Sheet3_column6].values.tolist()
stopTimeList = sheet3[Sheet3_column7].values.tolist()
BAGList = sheet3[Sheet3_column8].values.tolist()
periodList = sheet3[Sheet3_column9].values.tolist()
deltaPeriodList = sheet3[Sheet3_column10].values.tolist()
payloadLengthList = sheet3[Sheet3_column11].values.tolist()
deltaPayloadLengthList = sheet3[Sheet3_column12].values.tolist()
rhoList = sheet3[Sheet3_column13].values.tolist()
sigmaList = sheet3[Sheet3_column14].values.tolist()

ESNamesList = ESNamesList[0:endOfFile]
sourceIDList = sourceIDList[0:endOfFile]
sourceDatarateList = sourceDatarateList[0:endOfFile]
vlidList = vlidList[0:endOfFile]
startTimeList = startTimeList[0:endOfFile]
stopTimeList = stopTimeList[0:endOfFile]
BAGList = BAGList[0:endOfFile]
periodList = periodList[0:endOfFile]
deltaPeriodList = deltaPeriodList[0:endOfFile]
payloadLengthList = payloadLengthList[0:endOfFile]
deltaPayloadLengthList = deltaPayloadLengthList[0:endOfFile]
rhoList = rhoList[0:endOfFile]
sigmaList = sigmaList[0:endOfFile]


Sheet3_column1 = "End Systems"
Sheet3_column2 = "Source ID"
Sheet3_column3 = "Datarate of source"
Sheet3_column4 = "Cable Length"
Sheet3_column5 = "VLID"
Sheet3_column6 = "startTime"
Sheet3_column7 = "stopTime"
Sheet3_column8 = "BAG"
Sheet3_column9 = "Payload Length"
Sheet3_column10 = "Delta Payload Length"
Sheet3_column11 = "Period"
Sheet3_column12 = "Delta Period"
Sheet3_column13 = "rho"
Sheet3_column14 = "sigma"


iniStringMessageSet = [""] * endOfFile
for rowIndex in range(endOfFile):
    esIndex = 0
    sourceIndex = 0
    row = sheet3.loc[rowIndex].values.tolist()
    for colIndex in range(len(headerList)):
        if colIndex == 0:  # col: End System
            esName = row[colIndex]
            esIndex = esName[2:4]
        if colIndex == 1:  # col: Source ID
            sourceIndex = row[colIndex]
        if colIndex == 2:  # col: Datarate of Source
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].baudrate = {row[colIndex]} "
        if colIndex == 3:  # col: Cable length
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].cableLength = {row[colIndex]} "
        if colIndex == 4:  # col: VLID
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].afdxMarshall[{sourceIndex}].virtualLinkId = {row[colIndex]}\n "
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].partitionId = {row[colIndex]} "
        if colIndex == 5:  # col: startTime
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].startTime = {row[colIndex]} "
        if colIndex == 6:  # col: stopTime
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].stopTime = {row[colIndex]} "
        if colIndex == 7:  # col: BAG
            iniStringMessageSet[rowIndex] += f"**.ESGroup[{esIndex}].afdxMarshall[{sourceIndex}].BAG = {row[colIndex]} "
        if colIndex == 8:  # col: Period
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].interArrivalTime = {row[colIndex]} "
        if colIndex == 9:  # col: delta Period
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].deltaInterArrivalTimeMaxLimit = {row[colIndex]} "
        if colIndex == 10:  # col: Payload Length
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].trafficSource[{sourceIndex}].packetLength = {row[colIndex]} "
        if colIndex == 11:  # col: Delta Payload Length
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].afdxMarshall[{sourceIndex}].deltaPacketLengthMaxLimit = {row[colIndex]} "
        if colIndex == 12:  # col: rho
            iniStringMessageSet[rowIndex] += f"**.ESGroup[{esIndex}].afdxMarshall[{sourceIndex}].rho = {row[colIndex]} "
        if colIndex == 13:  # col: sigma
            iniStringMessageSet[
                rowIndex] += f"**.ESGroup[{esIndex}].afdxMarshall[{sourceIndex}].sigma = {row[colIndex]} "
        iniStringMessageSet[rowIndex] += "\n"

    print(ESInfoList[k].sourceID, ESInfoList[k].sourceDatarate, ESInfoList[k].sourceCableLength, ESInfoList[k].vlid, ESInfoList[k].startTime, ESInfoList[k].stopTime, ESInfoList[k].BAG,
ESInfoList[k].period, ESInfoList[k].deltaPeriod, ESInfoList[k].payloadLength, ESInfoList[k].deltaPayloadLength, ESInfoList[k].rho, ESInfoList[k].sigma)
